{"version":3,"file":"axios.umd.js","sources":["../../src/core/InterceptorManager.ts","../../src/core/xhr.ts","../../src/core/dispatchRequest.ts","../../src/core/Axios.ts","../../src/defaults.ts","../../src/helpers/mergeConfig.ts","../../src/ts-axios.ts"],"sourcesContent":["import { ResolvedFn, RejectedFn } from \"../types\";\r\n\r\n\r\ninterface Interceptor<T> {\r\n  resolved: ResolvedFn<T>\r\n  rejected?: RejectedFn\r\n}\r\n\r\nexport default class InterceptorManager<T> {\r\n  private interceptors: Array<Interceptor<T> | null>\r\n\r\n  constructor() {\r\n    this.interceptors = []\r\n  }\r\n\r\n  use(resolved: ResolvedFn<T>, rejected: RejectedFn): number {\r\n    this.interceptors.push({\r\n      resolved,\r\n      rejected\r\n    })\r\n    return this.interceptors.length - 1\r\n  }\r\n\r\n  forEach(fn: (interceptor: Interceptor<T>) => void): void {\r\n    this.interceptors.forEach(interceptor => {\r\n      if (interceptor !== null) {\r\n        fn(interceptor)\r\n      }\r\n    })\r\n  }\r\n\r\n  eject(id: number) {\r\n    if (this.interceptors[id]) {\r\n      this.interceptors[id] = null\r\n    }\r\n  }\r\n}","import { AxiosRequestConfig, AxiosPromise, AxiosResponse } from '../types'\r\n\r\nexport function xhr(config: AxiosRequestConfig): AxiosPromise {\r\n  return new Promise((resolve, reject) => {\r\n    const xhr = new XMLHttpRequest()\r\n    const { method = 'get', url, data = null } = config\r\n    xhr.open(method.toUpperCase(), url!)\r\n    xhr.send(data)\r\n    xhr.onreadystatechange = function handleLoad() {\r\n      if (xhr.readyState === 4 && xhr.status === 200) {\r\n        const headers = xhr.getAllResponseHeaders()\r\n        const responseData = xhr.response\r\n        const { status, statusText } = xhr\r\n\r\n        const response: AxiosResponse = {\r\n          data: responseData,\r\n          headers,\r\n          status,\r\n          statusText,\r\n          config,\r\n          request: xhr\r\n        }\r\n\r\n        resolve(response)\r\n      }\r\n    }\r\n    xhr.onerror = function() {\r\n      reject()\r\n    }\r\n  })\r\n}\r\n","import { AxiosRequestConfig, AxiosPromise } from '../types'\r\nimport { xhr } from './xhr'\r\n\r\nexport function dispatchRequest(config: AxiosRequestConfig): AxiosPromise {\r\n  // 前置处理，生命周期？？终止请求\r\n  return xhr(config)\r\n}\r\n","import { AxiosRequestConfig, AxiosPromise, AxiosResponse } from '../types'\r\nimport InterceptorManager from \"./InterceptorManager\"\r\nimport { dispatchRequest } from './dispatchRequest'\r\n\r\ninterface Interceptors {\r\n  request: InterceptorManager<AxiosRequestConfig>\r\n  response: InterceptorManager<AxiosResponse>\r\n}\r\n\r\nexport default class Axios {\r\n  defaults: AxiosRequestConfig\r\n\r\n  interceptors: Interceptors\r\n\r\n  constructor(initConfig: AxiosRequestConfig) {\r\n    this.defaults = initConfig\r\n    this.interceptors = {\r\n      request: new InterceptorManager<AxiosRequestConfig>(),\r\n      response: new InterceptorManager<AxiosResponse>()\r\n    }\r\n  }\r\n  request(config: AxiosRequestConfig): AxiosPromise {\r\n    return dispatchRequest(config)\r\n  }\r\n\r\n  get() {}\r\n}\r\n","import {AxiosRequestConfig} from \"./types\"\r\n\r\n\r\nconst defaults:AxiosRequestConfig = {\r\n  method: \"get\",\r\n\r\n}\r\n\r\nexport default defaults","import { AxiosRequestConfig } from '../types'\r\n\r\nexport function mergeConfig(\r\n  defaults: AxiosRequestConfig,\r\n  config?: AxiosRequestConfig\r\n): AxiosRequestConfig {\r\n  return Object.assign({}, defaults, config)\r\n}\r\n","// Import here Polyfills if needed. Recommended core-js (npm i -D core-js)\r\n// import \"core-js/fn/array.find\"\r\n// ...\r\n\r\nimport Axios from './core/Axios'\r\nimport defaults from './defaults'\r\nimport { mergeConfig } from './helpers/mergeConfig'\r\nimport { AxiosRequestConfig, AxiosStatic } from './types'\r\n\r\nfunction createInstance(defaultConfig: AxiosRequestConfig): any {\r\n  // any == AxiosStatic\r\n  const instance = new Axios(defaultConfig)\r\n  return instance\r\n}\r\n\r\nconst axios = createInstance(defaults)\r\n\r\naxios.create = function create(config: AxiosRequestConfig) {\r\n  return createInstance(mergeConfig(defaults, config))\r\n}\r\naxios.Axios = Axios\r\n\r\nexport default axios\r\n"],"names":[],"mappings":"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"}